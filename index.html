<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Pelanggan PLN</title>
</head>
<style>
    .button {
            display: inline-block;
            padding: 15px 30px;
            background-color: #28a745;
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-size: 18px;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.3s;
        }
</style>
<body>
    <table border="1">
        <thead id="table-head">
        </thead>
        <tbody id="data-body"></tbody>
    </table>

    <script>
        fetch("https://script.google.com/macros/s/AKfycbyIAFOh9FYp276GUrdvDmwAE6ckVxrInLbZFFd5pb2ectuYHYU3Pw3wLbBlAAnSlnrG/exec")
        .then(response => response.json())
        .then(data => {
            if (data.length === 0) return;
            
            let tableHead = document.getElementById("table-head");
            let tableBody = document.getElementById("data-body");
            
            // Membuat header tabel berdasarkan data
            let headerRow = "<tr><th>No</th>";
            Object.keys(data[0]).forEach(key => {
                headerRow += `<th>${key}</th>`;
            });
            headerRow += "</tr>";
            tableHead.innerHTML = headerRow;
            
            // Mengisi data dalam tabel
            data.forEach((item, index) => {
                let row = `<tr><td>${index + 1}</td>`;
                Object.keys(item).forEach(key => {
                    row += `<td>${item[key] || "-"}</td>`;
                });
                row += "</tr>";
                tableBody.innerHTML += row;
            });
        })
        .catch(error => console.error("Error fetching data:", error));
    </script>
     <nav>
        <p style="text-align:center;"><a href="halaman1.html" class="button">Kembali Menu Home</a></p>
    </nav>
</body>
</html>
